/*
 * wave.c
 *
 *  Created on: May 30, 2021
 *      Author: Nima Behmanesh
 */
#include "wave.h"
#define SIN_SIZE 99
#define SQUARE_SIZE 3

static uint8_t index = 0;

static uint16_t sin_list[100] =
{    1861,1979,2096,2213,2328,2441,2552,2660,2765,2867,
     2964,3057,3145,3228,3305,3376,3442,3501,3553,3599,
     3638,3669,3693,3710,3719,3721,3716,3703,3682,3654,
     3619,3577,3528,3472,3410,3341,3267,3187,3101,3011,
     2916,2816,2713,2607,2497,2385,2270,2155,2037,1920,
     1801,1684,1566,1451,1336,1224,1114,1008,905,805,
     710,620,534,454,380,311,249,193,144,102,67,39,18,
     5,0,2,11,28,52,83,122,168,220,279,345,416,493,576,
     664,757,854,956,1061,1169,1280,1393,1508,1625,1742,
     1861
};

static uint16_t saw_tooth[100] =
{1861,1898,1936,1974,2012,2050,2088,2126,2164,2202,
 2240,2278,2316,2354,2392,2430,2468,2506,2544,2582,
 2620,2658,2696,2734,2772,2810,2848,2886,2924,2962,
 3000,3038,3076,3114,3152,3190,3228,3266,3304,3342,
 3380,3418,3456,3494,3532,3570,3608,3646,3684,3722,
 0,37,75,113,151,189,227,265,303,341,379,417,455,
 493,531,569,607,645,683,721,759,797,835,873,911,949,
 987,1025,1063,1101,1139,1177,1215,1253,1291,1329,1367,
 1405,1443,1481,1519,1557,1595,1633,1671,1709,1747,
 1785,1823,1861};

static uint16_t square[100] =
{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
 4000,4000,4000, 4000, 4000, 4000, 4000, 4000,4000,4000,
 4000,4000,4000,4000,4000,4000,4000,4000,4000,4000,4000,
 4000,4000,4000,4000,4000,4000,4000,4000,4000,4000,4000,
 4000,4000,4000,4000,4000,4000,4000,4000,4000,4000,4000,
 4000,4000,4000,4000,4000,4000,4000};


uint16_t get_next_value(uint8_t wave_select)
{
    uint16_t output = 0;
    if (index > 99) index = 0;
    if (wave_select == 0) output = sin_list[index];
    else if (wave_select == 1) output = saw_tooth[index];
    else output = square[index];
    index += 1;
    return output;
}

void change_wave(uint8_t *wave_select)
{
    writeStringOffset("                 ", 17, FIRSTLINE);
    if (*wave_select == 2) *wave_select = 0;
    else *wave_select += 1;
    switch(*wave_select)
    {
    case 0:
        writeStringOffset("SINE", 4, FIRSTLINE);
        break;
    case 1:
        writeStringOffset("SAW TOOTH", 9, FIRSTLINE);
        break;
    case 2:
        writeStringOffset("SQUARE", 6, FIRSTLINE);
        break;
    default:
        writeStringOffset("NO WAVE", 5, FIRSTLINE);
    }
    debounce();
    debounce();
}
